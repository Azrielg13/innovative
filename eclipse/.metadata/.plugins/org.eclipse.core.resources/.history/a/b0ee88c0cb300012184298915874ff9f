package com.sce.esp.component.richtext;

import java.awt.event.ActionEvent;

import javax.swing.JTextPane;
import javax.swing.text.BadLocationException;
import javax.swing.text.StyledEditorKit;
import javax.swing.text.html.HTMLDocument;


public class InsertTextAction extends StyledEditorKit.StyledTextAction {

    /**
	 * 
	 */
	private static final long serialVersionUID = -4051656339544680473L;
	private MetaphaseEditorPanel editorPanel;
    private String text;

    public InsertTextAction(MetaphaseEditorPanel editorPanel, String actionName, String text) {
        super(actionName);
        this.editorPanel = editorPanel;
        this.text = text;
    }

    public void actionPerformed(ActionEvent ae) {
        try {
            JTextPane textPane = editorPanel.getHtmlTextPane();
            HTMLDocument doc = (HTMLDocument) textPane.getDocument();
            int pos = textPane.getCaretPosition();
            doc.insertString(pos, text, null);
            editorPanel.refreshAfterAction();
        } catch (BadLocationException e) {
            throw new MetaphaseEditorException(e.getMessage(), e);
        }
    }
}
