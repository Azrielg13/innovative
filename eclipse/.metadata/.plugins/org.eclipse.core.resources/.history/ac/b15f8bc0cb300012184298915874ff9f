package com.sce.esp.component.richtext;

import java.awt.event.ActionEvent;
import java.io.IOException;

import javax.swing.JTextPane;
import javax.swing.text.BadLocationException;
import javax.swing.text.StyledEditorKit;
import javax.swing.text.html.HTML.Tag;
import javax.swing.text.html.HTMLDocument;
import javax.swing.text.html.HTMLEditorKit;


public class InsertHtmlAction extends StyledEditorKit.StyledTextAction {

    /**
	 * 
	 */
	private static final long serialVersionUID = -3756588838202707167L;
	private MetaphaseEditorPanel editorPanel;
    private String html;
    private Tag htmlTag;
    private HTMLEditorKit editorKit = new HTMLEditorKit();

    public InsertHtmlAction(MetaphaseEditorPanel editorPanel, String actionName, String html, Tag htmlTag) {
        super(actionName);
        this.editorPanel = editorPanel;
        this.html = html;
        this.htmlTag = htmlTag;
    }

    public void actionPerformed(ActionEvent ae) {
        try {
            JTextPane textPane = editorPanel.getHtmlTextPane();
            HTMLDocument doc = (HTMLDocument) textPane.getDocument();
            int pos = textPane.getCaretPosition();
            editorKit.insertHTML(doc, pos, html, 0, 0, htmlTag);
            editorPanel.refreshAfterAction();
        } catch (IOException e) {
            throw new MetaphaseEditorException(e.getMessage(), e);
        } catch (BadLocationException e) {
            throw new MetaphaseEditorException(e.getMessage(), e);
        }
    }
}
