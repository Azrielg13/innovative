package com.sce.esp.object.model;

import java.awt.Image;
import java.sql.SQLException;
import java.util.Calendar;

import com.sce.esp.util.Calculate;

/**
 * Hold a Weather Forecast that is obtained from
 * NOAA using the <code>Weatherstation</code>lat & Lon.
 *  
 * @author Distribution Staff Engineering
 * @version 2.0
 */
public class ForecastWeather {
	
    private String dayName="";
    private String nightName="";
    private String maxT="";
    private String minT="";
    private String dayWeather="";
    private String nightWeather="";
    private String dayImg="";
    private String nightImg="";
    
    public Calendar date;
    private Weatherstation ws;
    private int dayNum;
    Calendar calDate=Calendar.getInstance();
    
    public ForecastWeather(){}
    
    public void setDate(Calendar c){
    	date=c;
    }
    
    public ForecastWeather(Calendar aDate){
    	date=aDate;    	
    }
    
    public ForecastWeather(Weatherstation aWs){
    	ws=aWs;    	
    }    
    
    public void setDayNum(int adayNum){
    	dayNum = adayNum;
    	calDate.add(Calendar.DATE, dayNum);
    }
    
    public double getEffTemp(){
    	double effTemp=0;
    	Calendar cal;
    	Temperature yester;
    	Temperature twoDaysAgo;
    	ForecastWeather[] f=null;
    	Calendar today = Calendar.getInstance();
    	int daysDiff = Calculate.getDaysDiff(calDate,today);//   	
		
		f = ws.getNoaaForecast();	  

    	try{    	
	    	switch(daysDiff){
		    	
	    		//Calc todays eff temp
	    		case 0:	    		
	    			cal = (Calendar)today.clone();
	    			cal.add(Calendar.DATE,-1);
	    			yester = Temperature.getInstance(ws.getPlanyear(),ws.getStationId(),cal);
	    			
	    			cal = (Calendar)today.clone();
	    			cal.add(Calendar.DATE,-2);
	    			twoDaysAgo = Temperature.getInstance(ws.getPlanyear(),ws.getStationId(),cal);
	    			
	    			return .7*Double.parseDouble(maxT)+.003*Double.parseDouble(minT)*yester.getMaxTemp()+.002*yester.getMinTemp()*twoDaysAgo.getMaxTemp();
	
	    		case 1:   			
					cal = (Calendar)today.clone();
		    		cal.add(Calendar.DATE,-1);
		    		twoDaysAgo = Temperature.getInstance(ws.getPlanyear(),ws.getStationId(),cal);    			
	    			
		    		return .7*Double.parseDouble(maxT)+.003*Double.parseDouble(minT)*Double.parseDouble(f[0].getMaxT())+.002*Double.parseDouble(f[0].getMinT())*twoDaysAgo.getMaxTemp();
		    	
	    		case 2: 
	    			return .7*Double.parseDouble(maxT)+.003*Double.parseDouble(minT)*Double.parseDouble(f[1].getMaxT())+.002*Double.parseDouble(f[1].getMinT())*Double.parseDouble(f[0].getMaxT());
	    		
	    		case 3:
	    			return .7*Double.parseDouble(maxT)+.003*Double.parseDouble(minT)*Double.parseDouble(f[2].getMaxT())+.002*Double.parseDouble(f[2].getMinT())*Double.parseDouble(f[1].getMaxT());
	    			
	    		case 4:
	    			return .7*Double.parseDouble(maxT)+.003*Double.parseDouble(minT)*Double.parseDouble(f[3].getMaxT())+.002*Double.parseDouble(f[3].getMinT())*Double.parseDouble(f[2].getMaxT());
	    			
	    		default:
		    		break;
	    	}    	
    	}catch(SQLException e){
    		e.printStackTrace();
    	}    	
    	return effTemp;
    }           

    public String getDayName() {
        return dayName;
    }

    public void setDayName(String aDayName) {
        dayName = aDayName;
    }

    public String getNightName() {
        return nightName;
    }

    public void setNightName(String aNightName) {
        nightName = aNightName;
    }

    public String getMaxT() {
        return maxT;
    }

    public void setMaxT(String aMaxT) {
        maxT = aMaxT;
    }

    public String getMinT() {
        return minT;
    }

    public void setMinT(String aMinT) {
        minT = aMinT;
    }

    public String getDayWeather() {
        return dayWeather;
    }

    public void setDayWeather(String aDayWeather) {
        dayWeather = aDayWeather;
    }

    public String getNightWeather() {
        return nightWeather;
    }

    public void setNightWeather(String aNightWeather) {
        nightWeather = aNightWeather;
    }

    public String getDayImg() {
        return dayImg;
    }

    public void setDayImg(String aDayImg) {
        dayImg = aDayImg;
    }

    public String getNightImg() {
        return nightImg;
    }

    public void setNightImg(String aNightImg) {
        nightImg = aNightImg;
    }

    Image dayImageIcon=null;
	public void setDayImgIcon(Image img) {
		dayImageIcon=img;		
	}
	
	public Image getDayImgIcon() {
		return dayImageIcon;		
	}

	Image nightImageIcon=null;
	public void setNightImgIcon(Image img) {
		nightImageIcon = img;		
	}
	
	public Image getNightImgIcon() {
		return nightImageIcon;
	}

	@Override
	public String toString() {
		return "ForecastWeather [date=" + date + ", dayName=" + dayName
				+ ", nightName=" + nightName + ", maxT=" + maxT + ", minT="
				+ minT + "]";
	}
	
	
}