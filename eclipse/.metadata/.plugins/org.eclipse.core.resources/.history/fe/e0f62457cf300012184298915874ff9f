package com.sce.esp.object.model;


import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Calendar;

import com.sce.esp.object.ESPTestCase;
import com.sce.esp.util.Calculate;

public class ProjContingencyTest extends ESPTestCase {
	public void testBestMatch() throws SQLException{
		assertNull(ProjContingency.getBestMatch(Program.DSP, CostStage.PLAN_EST, null, Calculate.getCal(1981, Calendar.MAY, 5)));
		assertNull(ProjContingency.getBestMatch(Program.DSP, CostStage.PLAN_EST, null, Calculate.getCal(1982, Calendar.MAY, 5)));
		assertNull(ProjContingency.getBestMatch(Program.DSP, CostStage.PLAN_EST, null, Calculate.getCal(1984, Calendar.MAY, 5)));
		ProjContingency pc1 = new ProjContingency();
		pc1.setProgramId(Program.DSP);
		pc1.setCostStageId(CostStage.PLAN_EST);
		pc1.setEffDate(Calculate.getCal(1981, Calendar.JUNE, 2));
		pc1.setRegCont(.1);
		pc1.setMajorCont(.25);
		pc1.insert();
		ProjContingency pc2 = new ProjContingency();
		pc2.setProgramId(Program.DSP);
		pc2.setCostStageId(CostStage.PLAN_EST);
		pc2.setEffDate(Calculate.getCal(1982, Calendar.JUNE, 2));
		pc2.setRegCont(.2);
		pc2.setMajorCont(.50);
		pc2.insert();
		assertNull(ProjContingency.getBestMatch(Program.DSP, CostStage.PLAN_EST, null, Calculate.getCal(1981, Calendar.MAY, 5)));
		assertEquals(pc1,ProjContingency.getBestMatch(Program.DSP, CostStage.PLAN_EST, null, Calculate.getCal(1982, Calendar.MAY, 5)));
		assertEquals(pc2,ProjContingency.getBestMatch(Program.DSP, CostStage.PLAN_EST, null, Calculate.getCal(1984, Calendar.MAY, 5)));
	}
	public void testDeleteAllMade() throws SQLException{
		Calendar cal = Calendar.getInstance();
		for(ProjContingency pc:new ArrayList<ProjContingency>(ProjContingency.getCollection(new String[]{"INSERT_USER_ID"}, User.getActiveUser().getUsernameId())))
			pc.deleteDB();
	}
}
